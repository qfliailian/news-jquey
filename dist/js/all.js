$(function(){function a(a,e){$.ajax({url:"https://apis.baidu.com/showapi_open_bus/channel_news/search_news",headers:{apikey:"5e7ac277afe4a93180724c96a31781ab"},data:{channelName:a,page:e},success:function(a){var e=a.showapi_res_body.pagebean.contentlist;return 0==e.length?void $("section").append("<p>抱歉API接口错误，没有数据返回</p>"):(setTimeout(n,1e3),void $(e).map(function(a,e){var n=e.imageurls.length,t=$("<div>").addClass("list"),s=$("<a>").attr({href:e.link});t.append(s);var i=$("<h2>").html(e.title),o=$("<p><span class='source'>"+e.source+"</span><span class='pubdate'>"+e.pubDate+"</span></p>");if(1==n)s.addClass("item item-thumbnail-left"),$("<img>").attr({src:e.imageurls[0].url}).appendTo(s),i.appendTo(s),o.appendTo(s);else if(0==n)s.addClass("item"),i.appendTo(s),o.appendTo(s);else if(n>=3){s.addClass("item"),i.appendTo(s);for(var d=$("<ul>"),p=document.createDocumentFragment(),l=0;l<3;l++){var c=$("<img>").attr({src:e.imageurls[l].url});$("<li>").addClass("pic").append(c).appendTo($(p))}$(p).appendTo(d),d.appendTo(s),o.appendTo(s)}$("section").append(t)}))}})}function e(){$(".loading").show(),$("div.loading>div").css("animation","run 2s linear infinite")}function n(){$(".loading").hide(),$(".loading>div").css("anmation","")}var t="国内最新";a(t,1),$("div.newsItem").on("touchstart",function(){$("section").html(""),$("div.newsItem").removeClass("active"),$(this).addClass("active"),t=$(this).html(),a(t,1)}),$(".load_list").map(function(a,e){$(this).css({transform:"rotateZ("+45*a+"deg) translateY(20px) "})});var s=$("div.scrollTop"),i=0,o=1;$(window).scroll(function(){var n=$(this).scrollTop();n>=$(this).height()?s.show():s.hide(),n>=$(document).height()-$(window).height()&&(i++,console.log("已经到底"),i>=2&&(i=0,o++,a(t,o),e()))}),s.on("touchstart",function(){$("html,body").animate({scrollTop:0})})});
